create view lowRating as (
select lrm.*, row_number() over (partition by lrm.year) as rnk from
(select m.title, m.year, m.rating from movies as m, 
(select m.year , min(m.rating) as lowest_rating from movies as m
where m.year >= 2005 and m.year <= 2011
group by m.year
order by m.year asc) as temp where
m.rating = temp.lowest_rating and m.year= temp.year
order by m.year asc, m.title asc) as lrm)




create view highRating as ( 
select hrm.*, row_number() over (partition by hrm.year) as rnk from
(select m.title, m.year, m.rating
from movies as m, 
(select m.year , max(m.rating) as highest_rating from movies as m
where m.year >= 2005 and m.year <= 2011
group by m.year
order by m.year asc) as temp where 
m.rating = temp.highest_rating and m.year= temp.year
order by m.year asc, m.title asc) as hrm)



Select hl.* from 
(select hr.title, hr.year, hr.rating from highRating as hr where hr.rnk =1
union
select lr.title, lr.year, lr.rating from lowRating as lr where lr.rnk =1) as hl
order by hl.year, hl.rating